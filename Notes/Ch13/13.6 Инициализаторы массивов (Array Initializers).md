2025-11-04 13:06
Tags: #


- Синтаксис `{…}` и `new T[]{…}`, многомерные инициализаторы, ограничения.
    
- Примеры ×3 / ошибки ×2 / подводные камни.
    
- ✅ Заменить ссылки на официальные Oracle/JLS при финализации.

(убрать ссылки на SO, заменить на Oracle при наполнении)

### Формальное определение

- «Array initializer: A brace‐enclosed, comma-separated list of expressions, optionally trailing comma, used to initialize an array. A variable declarator may include an array initializer. An array initializer may be used in a class instance creation expression but only if the array creation expression is of the form `new T[]{...}`. » ([Stack Overflow](https://stackoverflow.com/questions/54588887/why-java-prohibits-array-initializer-as-a-method-invocation-argument?utm_source=chatgpt.com "Why Java prohibits array initializer as a method invocation ..."))
    
- Также: «The length of the array is determined by the number of expressions in the initializer list.» ([Stack Overflow](https://stackoverflow.com/questions/1200621/how-do-i-declare-and-initialize-an-array-in-java?utm_source=chatgpt.com "How do I declare and initialize an array in Java? - Stack Overflow"))
    

### Подтемы

6.1. Синтаксис и семантика  
6.2. Одномерные и многомерные инициализаторы  
6.3. Комбинации `new` и инициализатора  
6.4. Ограничения и нестандартные формы

### Развёрнутое пояснение

**6.1 Синтаксис:**  
Пример: `int[] a = {1, 2, 3};` – объявление с инициализатором. Или `int[] a = new int[]{1,2,3};`. В метод-параметре нельзя использовать просто `{1,2,3}` без `new int[]`. ([Stack Overflow](https://stackoverflow.com/questions/54588887/why-java-prohibits-array-initializer-as-a-method-invocation-argument?utm_source=chatgpt.com "Why Java prohibits array initializer as a method invocation ..."))  
**6.2 Многомерные:**  
Например: `int[][] b = { {1,2}, {3,4,5} };` – тут двумерный массив, строки имеют разную длину (также допускается).  
**6.3 Комбинации:**  
Инициализатор можно использовать только при объявлении или при `new T[]{...}`. Нельзя `void foo(int[] x){ ... } foo({1,2,3});` – это ошибка. ([Stack Overflow](https://stackoverflow.com/questions/54588887/why-java-prohibits-array-initializer-as-a-method-invocation-argument?utm_source=chatgpt.com "Why Java prohibits array initializer as a method invocation ..."))  
**6.4 Ограничения:**  
При создании надо либо указать размеры (без инициализатора) либо использовать инициализатор (без указания размеров). Например, `new int[3] {1,2,3}` — недопустимо.

### Примеры (корректные)

```java
// Пример 1
int[] a = {10,20,30};

// Пример 2
String[][] names = { {"Alice","Bob"}, {"Carol"} };

// Пример 3
double[] d = new double[]{1.1,2.2,3.3};
```

### Примеры (ошибочные)

```java
// Ошибка 1
int[] a2 = new int[3] {1,2,3};     // compile-time error

// Ошибка 2
void foo(int[] arr) { … }
foo({1,2,3});                       // compile-time error: array initializer not allowed here
```

### Типичные ошибки и подводные камни

- Часто путают: можно ли сразу объявить и инициализировать без `new` – да в объявлении; но нельзя в передаче параметром.
    
- Подводный момент: при многомерных инициализаторах длины строк могут отличаться – это не ошибка, но может привести к неожиданным результатам при обходе.
    
- Ошибка: считать, что после инициализации можно изменить длину массива – нельзя.
    
