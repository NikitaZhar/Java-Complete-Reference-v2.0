2025-10-29 19:37
Tags: #

Tree Model –≤ Jackson –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç JSON –∫–∞–∫ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —á–∞—Å—Ç–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å—Ä–∞–∑—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –µ–≥–æ –≤ —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Java-–∫–ª–∞—Å—Å. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π JSON, —Å–ª–æ–∂–Ω—ã–º–∏ API, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ middleware –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π.

---

### **58.3.6.1. –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã —É–∑–ª–æ–≤**

Jackson –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π `JsonNode`:

|–¢–∏–ø|–ö–ª–∞—Å—Å|–ü—Ä–∏–º–µ—Ä JSON|
|---|---|---|
|–û–±—ä–µ–∫—Ç–Ω—ã–π —É–∑–µ–ª|`ObjectNode`|`{ "a": 1 }`|
|–ú–∞—Å—Å–∏–≤–Ω—ã–π —É–∑–µ–ª|`ArrayNode`|`[1, 2, 3]`|
|–ó–Ω–∞—á–µ–Ω–∏–µ (—Å—Ç—Ä–æ–∫–∞)|`TextNode`|`"abc"`|
|–ó–Ω–∞—á–µ–Ω–∏–µ (—á–∏—Å–ª–æ)|`IntNode`|`123`|
|–ë—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ|`BooleanNode`|`true`|
|–ü—É—Å—Ç–æ–π —É–∑–µ–ª|`NullNode`|`null`|
|–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —É–∑–µ–ª|`MissingNode`|_(–Ω–µ—Ç –≤ JSON)_|

---

### **58.3.6.2. –ß—Ç–µ–Ω–∏–µ JSON –∫–∞–∫ –¥–µ—Ä–µ–≤–∞**

```java
ObjectMapper mapper = new ObjectMapper();
JsonNode root = mapper.readTree(jsonString);
String name = root.get("name").asText();
int age = root.get("age").asInt();
```

üîπ `get()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null`, –µ—Å–ª–∏ —É–∑–µ–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.  
üîπ `asText()`, `asInt()`, `asBoolean()` –±–µ–∑–æ–ø–∞—Å–Ω—ã ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è `NullPointerException`.

---

### **58.3.6.3. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `path()`**

```java
String city = root.path("address").path("city").asText("Unknown");
```

‚úÖ `path()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `MissingNode`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ.  
‚úÖ –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

58.3.6.3a. JSON Pointer (`at`)
```java
String first = root.at("/users/0/name").asText();
JsonNode missing = root.at("/no/such/path"); // MissingNode
```
`at()` —Ä–µ–∞–ª–∏–∑—É–µ—Ç JSON Pointer; —É–¥–æ–±–µ–Ω –¥–ª—è –≥–ª—É–±–æ–∫–æ–π –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫.



### **58.3.6.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∑–ª–æ–≤**

```java
if (root.has("user") && root.get("user").hasNonNull("email")) {
    String email = root.get("user").get("email").asText();
}
```

|–ú–µ—Ç–æ–¥|–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ|
|---|---|
|`has()`|–ø–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–º–æ–∂–µ—Ç –±—ã—Ç—å null)|
|`hasNonNull()`|–ø–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ null|
|`isTextual()`|—É–∑–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫—É|
|`isArray()`|–º–∞—Å—Å–∏–≤|
|`isObject()`|–æ–±—ä–µ–∫—Ç JSON|

---

### **58.3.6.5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ JsonNode**

–î–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É–∑–µ–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∏–ø–∞ `ObjectNode` –∏–ª–∏ `ArrayNode`:

```java
ObjectNode userNode = (ObjectNode) root.get("user");
userNode.put("active", true);
userNode.remove("password");
```

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤:

```java
ArrayNode roles = mapper.createArrayNode();
roles.add("ADMIN").add("USER");
userNode.set("roles", roles);
```

---

### **58.3.6.6. –°–æ–∑–¥–∞–Ω–∏–µ JSON –≤—Ä—É—á–Ω—É—é**

```java
ObjectNode user = mapper.createObjectNode();
user.put("name", "Alice");
user.put("age", 30);

ArrayNode skills = mapper.createArrayNode();
skills.add("Java").add("JSON");
user.set("skills", skills);

String json = mapper.writeValueAsString(user);
```

---

### **58.3.6.7. –ú–æ—Å—Ç –º–µ–∂–¥—É Tree Model –∏ Data Binding**

#### ‚úÖ Tree ‚Üí Java Object

```java
JsonNode userNode = root.get("user");
User user = mapper.treeToValue(userNode, User.class);
```

#### ‚úÖ Java Object ‚Üí Tree

```java
JsonNode node = mapper.valueToTree(user);
```

–≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —à–∞–±–ª–æ–Ω–∞—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤, middleware, —Å–∏—Å—Ç–µ–º–∞—Ö —Å –≥–∏–±–∫–æ–π —Å—Ö–µ–º–æ–π JSON (Kafka, REST, GraphQL).

---

### **58.3.6.8. –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ü–æ–¥—Ö–æ–¥|
|---|---|
|–ò–∑–≤–ª–µ—á—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö|–ß—Ç–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `JsonNode`|
|–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å JSON –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π|–ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `ObjectNode`|
|–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–π|–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `has()` –∏ `path()`|
|–ß–∞—Å—Ç–∏—á–Ω–æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç|`treeToValue()`|
|–°–æ–∑–¥–∞—Ç—å JSON –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏|`ObjectNode` + `ArrayNode`|

---

### **58.3.6.9. Edge Cases –∏ –æ—à–∏–±–∫–∏**

‚ùå **–û—à–∏–±–∫–∞: –ø–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–≥–æ —É–∑–ª–∞**

```java
root.get("name").put("first", "Bob"); // IllegalStateException
```

‚úÖ –ù—É–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ `ObjectNode`:

```java
((ObjectNode) root).put("name", "Bob");
```

‚ùå **–ü–æ—Ç–µ—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ Tree ‚Üí POJO, –µ—Å–ª–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è**  
–ï—Å–ª–∏ –∫–ª–∞—Å—Å –∏–º–µ–µ—Ç `@JsonIgnore` –Ω–∞ –ø–æ–ª–µ, `treeToValue()` –ø—Ä–∏–º–µ–Ω–∏—Ç —ç—Ç—É –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é.

- `MissingNode` vs `NullNode`: `asText()` –Ω–∞ –æ–±–æ–∏—Ö –≤–µ—Ä–Ω—ë—Ç `""` (–∏–ª–∏ –¥–µ—Ñ–æ–ª—Ç), –Ω–æ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ —Ä–∞–∑–Ω–∞—è: ¬´–Ω–µ—Ç —É–∑–ª–∞¬ª vs ¬´–∑–Ω–∞—á–µ–Ω–∏–µ null¬ª.
    
- –î–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–ø–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `deepCopy()`; –ø—Ä–æ—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.



### **58.3.6.10. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –≤—ã–±–æ—Ä API**

|API|–ü–∞–º—è—Ç—å|–°–∫–æ—Ä–æ—Å—Ç—å|–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ|
|---|---|---|---|
|Streaming|üîπ –ù–∏–∑–∫–∞—è|üîπ –í—ã—Å–æ–∫–∞—è|–ë–æ–ª—å—à–∏–µ –ø–æ—Ç–æ–∫–∏, pipeline-–ø–∞—Ä—Å–∏–Ω–≥|
|Tree|üî∏ –°—Ä–µ–¥–Ω—è—è|üî∏ –°—Ä–µ–¥–Ω—è—è|–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —á–∞—Å—Ç–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞|
|Data Binding|üî∏ –í—ã—à–µ|üîπ –í—ã—Å–æ–∫–∞—è|DTO, REST, —Å—Ç—Ä–æ–≥–∏–µ –∫–ª–∞—Å—Å—ã|

---

### **–í—ã–≤–æ–¥—ã**

- Tree Model ‚Äî –∫–ª—é—á–µ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è _–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è JSON_.
    
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ —á–∞—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON.
    
- `JsonNode` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ "–º–æ—Å—Ç" –º–µ–∂–¥—É low-level –∏ high-level API.
    
- –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Tree Model **—á–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç—Å—è —Å ObjectMapper**: —Å–Ω–∞—á–∞–ª–∞ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –¥–µ—Ä–µ–≤–æ, –∑–∞—Ç–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ Java-–∫–ª–∞—Å—Å —Ç–æ–ª—å–∫–æ —Ç–µ —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã.
    


