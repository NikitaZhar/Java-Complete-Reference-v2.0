2025-10-29 19:42
Tags: #toFormat 

_(–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏, high-load API –∏ –ø–æ—Ç–æ–∫–∞–º–∏ —Å–æ–±—ã—Ç–∏–π)_

Jackson ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö JSON-–ø–∞—Ä—Å–µ—Ä–æ–≤ –Ω–∞ JVM. –ù–æ **–ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —Ä–µ–∑–∫–æ —É–ø–∞—Å—Ç—å**, –∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ JSON.

---

# üî∑ **58.3.9.1. –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ—Ç–µ—Ä—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

|–ü—Ä–æ–±–ª–µ–º–∞|–ü—Ä–∏—á–∏–Ω–∞|–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è|
|---|---|---|
|–ß–∞—Å—Ç–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `ObjectMapper`|–°–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–µ–π, –∞–Ω–∞–ª–∏–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π|–í—ã—Å–æ–∫–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã|
|–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–¥—É–ª–µ–π|–ó–Ω–∞—á–µ–Ω–∏—è —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ—Ñ–ª–µ–∫—Å–∏—é|–ú–µ–¥–ª–µ–Ω–Ω–∞—è (–¥–µ)—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è|
|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Data Binding –¥–ª—è –±–æ–ª—å—à–∏—Ö JSON|–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏|OutOfMemoryError|
|–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä API|JsonNode –≤–º–µ—Å—Ç–æ Streaming|–ü–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥ –ø–∞–º—è—Ç–∏|
|–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤|–ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è —Å—Ö–µ–º|–ü–æ—Ç–µ—Ä—è –≤—Ä–µ–º–µ–Ω–∏|

---

# ‚úÖ **58.3.9.2. ObjectMapper –∫–∞–∫ Singleton**

`ObjectMapper` –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–µ–Ω _–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏_. –ï–≥–æ —Å–ª–µ–¥—É–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å **–æ–¥–∏–Ω —Ä–∞–∑**:

```java
public class JsonUtils {
    public static final ObjectMapper MAPPER = new ObjectMapper()
            .registerModule(new JavaTimeModule())
            .disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
}
```

‚ö† –ù–ï–õ–¨–ó–Ø:

```java
// –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω: —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ ObjectMapper –∫–∞–∂–¥—ã–π —Ä–∞–∑
ObjectMapper mapper = new ObjectMapper();
```

---

# üöÄ **58.3.9.3. Jackson Afterburner ‚Äì —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã**

```java
mapper.registerModule(new AfterburnerModule());
```

üîπ –£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 40%  
üîπ Bytecode generation –≤–º–µ—Å—Ç–æ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏  
üîπ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Java 8+  
‚ö† –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å GraalVM Native Image –∏ Android

---

# üß† **58.3.9.4. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤**

Jackson –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–µ—à–∏—Ä—É–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞.  
–≠—Ç–æ **–ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π ObjectMapper –∫–∞–∂–¥—ã–π —Ä–∞–∑** ‚Äì –∫–µ—à —Ç–µ—Ä—è–µ—Ç—Å—è!

### Zero-copy –∏ –º–∏–Ω–∏–º—É–º –∞–ª–ª–æ–∫–∞—Ü–∏–π

- –ü–∏—à–∏—Ç–µ **—Å—Ä–∞–∑—É** –≤ `OutputStream`/`Writer`, –∏–∑–±–µ–≥–∞–π—Ç–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö `String`.
    
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `JsonGenerator` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `writerFor(...).writeValue(gen, value)`.
    
- –†–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ObjectWriter`/`ObjectReader` –∫–∞–∫ –ø–æ–ª—è/–±–∏–Ω—ã.
---

# üîÑ **58.3.9.5. –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Streaming) –≤–º–µ—Å—Ç–æ Data Binding**

|API|–°–∫–æ—Ä–æ—Å—Ç—å|–ü–∞–º—è—Ç—å|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ|
|---|---|---|---|
|Streaming|üî• –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è|üî• –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è|–ë–æ–ª—å—à–∏–µ JSON-—Ñ–∞–π–ª—ã, –ø–æ—Ç–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ|
|Data Binding|‚úÖ –í—ã—Å–æ–∫–∞—è|üî∏ –°—Ä–µ–¥–Ω—è—è|DTO, REST API|
|Tree Model|üî∏ –°—Ä–µ–¥–Ω—è—è|üî∏ –°—Ä–µ–¥–Ω—è—è|–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ JSON|

### –ü—Ä–∏–º–µ—Ä: –ø–æ—Ç–æ–∫–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞

```java
try (JsonParser parser = mapper.getFactory().createParser(file)) {
    while (parser.nextToken() != JsonToken.END_ARRAY) {
        JsonNode node = parser.readValueAsTree();
        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    }
}
```

---

# üìè **58.3.9.6. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ InputStream**

```java
try (BufferedInputStream bis = new BufferedInputStream(new FileInputStream("data.json"))) {
    JsonNode node = mapper.readTree(bis);
}
```

‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è  
‚úÖ –£–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å I/O

---

# üì¶ **58.3.9.7. Memory Footprint Optimization**

‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@JsonIgnoreProperties` –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π**

‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@JsonInclude(JsonInclude.Include.NON_NULL)`**

‚úÖ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã Writer/Reader (–ø—É–ª)**

‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ObjectWriter` –∏ `ObjectReader`**

```java
ObjectReader reader = mapper.readerFor(User.class);
ObjectWriter writer = mapper.writerFor(User.class);
```

‚û° –≠—Ç–∏ –æ–±—ä–µ–∫—Ç—ã —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–µ—à–∏ (—Ç–∏–ø–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã).

---

# üîê **58.3.9.8. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º–∞**

‚ö† –ü–æ–ª–∏–º–æ—Ä—Ñ–Ω–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (`@JsonTypeInfo`) —Ç—è–∂–µ–ª–µ–µ, —á–µ–º –æ–±—ã—á–Ω–∞—è, —Ç.–∫. —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ —Ç–∏–ø–∞.

‚úÖ –î–ª—è REST –∏ –ø—É–±–ª–∏—á–Ω—ã—Ö API —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è _—è–≤–Ω–æ–µ –ø–æ–ª–µ —Ç–∏–ø–∞_ –≤–º–µ—Å—Ç–æ `JsonTypeInfo`.

---

# ‚öô **58.3.9.9. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å StringBuilderWriter –¥–ª—è –∑–∞–ø–∏—Å–∏**

```java
StringWriter writer = new StringWriter(1024);
mapper.writeValue(writer, data);
```

### **–ü—Ä—è–º–æ–π –≤—ã–≤–æ–¥ –≤ OutputStream –≤–º–µ—Å—Ç–æ String**

```java
mapper.writeValue(response.getOutputStream(), data);
```

‚û° –ò–∑–±–µ–≥–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

#### **58.3.9.9a. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è**

- **JFR/JMC**, **async-profiler** ‚Äî —Å–º–æ—Ç—Ä–∏ –Ω–∞ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫/–±—É—Ñ–µ—Ä–æ–≤, —á–∞—Å—Ç–æ—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è `ObjectMapper`.
    
- **Afterburner**: –¥–∞—ë—Ç –ø—Ä–∏—Ä–æ—Å—Ç **–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—è—Ö**; –≤—Å–µ–≥–¥–∞ **–∏–∑–º–µ—Ä—è–π—Ç–µ –Ω–∞ —Å–≤–æ–µ–π –Ω–∞–≥—Ä—É–∑–∫–µ**. JIT/escape analysis –∏–Ω–æ–≥–¥–∞ –Ω–∏–≤–µ–ª–∏—Ä—É–µ—Ç –≤—ã–∏–≥—Ä—ã—à.
    
---

# ‚ö° **58.3.9.10. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (–ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –ø–∞–º—è—Ç–∏)**

|–ü–æ–¥—Ö–æ–¥|–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å|–ü–∞–º—è—Ç—å|–°–ª–æ–∂–Ω–æ—Å—Ç—å|
|---|---|---|---|
|ObjectMapper (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)|–°—Ä–µ–¥–Ω—è—è|–°—Ä–µ–¥–Ω—è—è|–ù–∏–∑–∫–∞—è|
|ObjectReader/Writer|–í—ã—à–µ|–°—Ä–µ–¥–Ω—è—è|–°—Ä–µ–¥–Ω—è—è|
|Afterburner|–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è|–°—Ä–µ–¥–Ω—è—è|–°—Ä–µ–¥–Ω—è—è|
|Streaming API|–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è|–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è|–í—ã—Å–æ–∫–∞—è|
|Tree Model|–°—Ä–µ–¥–Ω—è—è|–°—Ä–µ–¥–Ω—è—è|–°—Ä–µ–¥–Ω—è—è|

---

# ‚úÖ **58.3.9.11. –í—ã–≤–æ–¥—ã**

- **ObjectMapper –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Singleton** ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    
- **Afterburner module** ‚Äî –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —É—Å–∫–æ—Ä–∏—Ç—å Jackson –Ω–∞ 20‚Äì40%.
    
- **Streaming API** ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
    
- **ObjectReader/ObjectWriter** ‚Äî –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ç—Ä–æ–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ pipeline.
    
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–ª—å–∑—è –Ω–∞—Ä—É—à–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –Ω–æ–≤—ã—Ö ObjectMapper.
    

> üìå _–í–ª–∏—è–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Jackson –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã—à–µ, —á–µ–º –≤—ã–±–æ—Ä –¥—Ä—É–≥–æ–π JSON-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏._


