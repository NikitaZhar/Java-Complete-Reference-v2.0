2025-11-04 13:05
Tags: #


- Индексация (0..length-1), типы индекса, многомерный доступ.
    
- Примеры ×3 / ошибки ×2 / подводные камни.
    
- Схема доступа — уже есть.

### Формальное определение

- «A component of an array is accessed by an array access expression (§15.12) that consists of an expression whose value is an array reference followed by an indexing expression enclosed by `[` and `]`, as in `A[i]`. All arrays are 0-origin. An array with length n can be indexed by the integers 0 to n-1, inclusive.» ([titanium.cs.berkeley.edu](https://titanium.cs.berkeley.edu/doc/java-langspec-1.0/10.doc.html?utm_source=chatgpt.com "The Java Language Specification Arrays"))
    

### Подтемы

4.1. Выражение доступа `arrayRef[index]`  
4.2. Индексная граница (0 … length-1)  
4.3. Многомерные массивы (аналогично по каждому измерению)  
4.4. Разрешённые типы индекса (int, короткие, байты с неявной конверсией и т.п.)  
4.5. Последствия доступа (присваивание, чтение)

### Развёрнутое пояснение

**4.1 Синтаксис и семантика:**  
Если `a` имеет тип `T[]`, то выражение `a[i]` имеет тип `T` (если чтение) или допускает присваивание значения типа T (если лево-часть). Передавать `i` должно быть целочисленное выражение (после преобразований) с результатом неотрицательным и меньшим чем `a.length`.  
**4.2 Индексные границы:**  
Если `i < 0` или `i >= a.length`, во время выполнения выбрасывается `ArrayIndexOutOfBoundsException`.  
**4.3 Многомерные массивы:**  
Например, `b[i][j]` – первый доступ `b[i]` получает массив `T[]`, затем `[j]` доступ к компоненту.  
**4.4 Типы индекса:**  
Индекс выражается как целое число; допустимы типы `byte`, `short`, `int`, `char` (после конверсии). Тип `long` нельзя без приведения.  
**4.5 Присваивание и чтение:**  
Чтение: `T x = a[i];`. Присваивание: `a[i] = v;` где `v` должен быть либо `null` (если ссылочный тип) либо совместимым с T.

### Схема доступа

```
arrayRef[index]
   ├── arrayRef → reference, значение типа U[] где U = component type
   └── index    → int-конвертированное выражение i
```

### Примеры (корректные)

```java
// Пример 1
int[] arr = new int[5];
arr[0] = 10;
int x = arr[0];

// Пример 2
String[][] names = new String[2][3];
names[1][2] = "John";
String s = names[1][2];

// Пример 3
double[] data = {1.0,2.0,3.5};
for(int i = 0; i < data.length; i++){
    data[i] += 1.0;
}
```

### Примеры (ошибочные)

```java
// Ошибка 1
int[] a = new int[3];
int y = a[3];                   // runtime: ArrayIndexOutOfBoundsException

// Ошибка 2
String[][] m = new String[2][];
String t = m[1][0];            // runtime: NullPointerException (m[1] == null)
```

### Типичные ошибки и подводные камни

- Часто забывают, что индексация начинается с 0, а не 1.
    
- При двумерных/многомерных массивах забывают инициализировать внутренние массивы (`new T[2][]`) – получат `null`.
    
- Использование `long` для индексация массива: `a[0L]` – компилятор не разрешит; требуется `int`.
    
- Проверка `i < a.length` забывается – приводит к `ArrayIndexOutOfBoundsException`.
    
